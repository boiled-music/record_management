<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì„œê³ ê´€ë¦¬ ì‹œìŠ¤í…œ - ë³´ìœ  ë¬¸ì„œ ëª©ë¡</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">
</head>
<body>

    <!-- âœ… ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">ì„œê³ ê´€ë¦¬ ì‹œìŠ¤í…œ</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="/documents">ë³´ìœ ëª©ë¡ ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">ëŒ€ì¶œ/ë°˜ë‚© ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">í‰ê°€/íê¸° ê´€ë¦¬</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">ê²€ìƒ‰/í™œìš©</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">ë¡œê·¸</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">í†µê³„</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h1 class="text-center">ğŸ“„ ë³´ìœ  ë¬¸ì„œ ëª©ë¡</h1>

        <!-- âœ… ê²€ìƒ‰ í¼ -->
        <form method="GET" action="/documents" class="row g-3 mb-4">
            <div class="col-md-2">
                <input type="text" name="management_number" class="form-control" placeholder="ì„œê³ ê´€ë¦¬ ë²ˆí˜¸" value="{{ request.args.get('management_number', '') }}">
            </div>
            <div class="col-md-2">
                <input type="text" name="production_department" class="form-control" placeholder="ìƒì‚°ë¶€ì„œ" value="{{ request.args.get('production_department', '') }}">
            </div>
            <div class="col-md-2">
                <input type="number" name="start_year" class="form-control" placeholder="ìƒì‚°ë…„ë„(ì‹œì‘)" value="{{ request.args.get('start_year', '') }}">
            </div>
            <div class="col-md-2">
                <input type="number" name="end_year" class="form-control" placeholder="ìƒì‚°ë…„ë„(ì¢…ë£Œ)" value="{{ request.args.get('end_year', '') }}">
            </div>
            <div class="col-md-2">
                <input type="text" name="folder_title" class="form-control" placeholder="ê¸°ë¡ë¬¼ì²  ì œëª©" value="{{ request.args.get('folder_title', '') }}">
            </div>
            <div class="col-md-2">
                <select name="preservation_period" class="form-select">
                    <option value="">ë³´ì¡´ê¸°ê°„ ì„ íƒ</option>
                    <option value="30ë…„">ì˜êµ¬</option>
                    <option value="30ë…„">ì¤€ì˜êµ¬</option>
                    <option value="30ë…„">30ë…„</option>
                    <option value="10ë…„">10ë…„</option>
                    <option value="5ë…„">5ë…„</option>
                    <option value="3ë…„">3ë…„</option>
                    <option value="1ë…„">1ë…„</option>
                </select>
            </div>
            <div class="col-md-2">
                <select name="document_type" class="form-select">
                    <option value="">í˜•íƒœ ì„ íƒ</option>
                    <option value="ë¬¸ì„œ">ë¬¸ì„œ</option>
                    <option value="30ë…„">ëŒ€ì¥</option>
                    <option value="30ë…„">ì¹´ë“œ</option>
                    <option value="ë„ë©´">ë„ë©´</option>
                    <option value="ì‚¬ì§„">ì‹œì²­ê°</option>
                </select>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">ê²€ìƒ‰</button>
            </div>
        </form>

        <!-- âœ… CSV ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ -->
        <div class="mb-3 text-end">
            <a href="/download_csv" class="btn btn-success">CSV ë‹¤ìš´ë¡œë“œ</a>
        </div>

        <!-- âœ… í˜ì´ì§€ë‹¹ í‘œì‹œ ê°œìˆ˜ ì„ íƒ -->
        <form method="GET" action="/documents" class="mb-3 d-flex align-items-center">
            <label for="per_page" class="me-2">í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜:</label>
            <select name="per_page" onchange="this.form.submit()" class="form-select w-auto">
                {% for size in [10, 20, 30, 50, 100, 500, 1000] %}
                    <option value="{{ size }}" {% if per_page == size %}selected{% endif %}>{{ size }}</option>
                {% endfor %}
            </select>
        </form>

        <!-- âœ… ë¬¸ì„œ ëª©ë¡ í…Œì´ë¸” -->
        <table class="table table-bordered table-striped text-center">
            <thead>
                <tr>
                    <th><a href="?sort_by=id&sort_order={{ 'desc' if sort_order == 'asc' else 'asc' }}">ì—°ë²ˆ â¬</a></th>
                    <th>ê´€ë¦¬ë²ˆí˜¸</th>
                    <th>í˜„ì¬ê¸°ê´€ëª…</th>
                    <th>ìƒì‚°ë¶€ì„œ</th>
                    <th>ìƒì‚°ë…„ë„</th>
                    <th>ê¸°ë¡ë¬¼ì²  ì œëª©</th>
                    <th>ë³´ì¡´ê¸°ê°„</th>
                    <th>í˜•íƒœ</th>
                    <th>ìˆ˜ëŸ‰</th>
                </tr>
            </thead>
            <tbody>
                {% for doc in documents %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ doc.management_number }}</td>
                    <td>{{ doc.current_institution }}</td>
                    <td>{{ doc.production_department }}</td>
                    <td>{{ doc.production_year }}</td>
                    <td>{{ doc.folder_title }}</td>
                    <td>{{ doc.preservation_period }}</td>
                    <td>{{ doc.document_type }}</td>
                    <td>{{ doc.quantity }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- âœ… í˜ì´ì§€ë„¤ì´ì…˜ -->
        <nav>
            <ul class="pagination justify-content-center">
                {% if current_page > 1 %}
                    <li class="page-item"><a class="page-link" href="?page={{ current_page - 1 }}">&laquo; ì´ì „</a></li>
                {% endif %}

                {% for page_num in range(1, total_pages + 1) %}
                    <li class="page-item {% if page_num == current_page %}active{% endif %}">
                        <a class="page-link" href="?page={{ page_num }}&per_page={{ per_page }}">{{ page_num }}</a>
                    </li>
                {% endfor %}

                {% if current_page < total_pages %}
                    <li class="page-item"><a class="page-link" href="?page={{ current_page + 1 }}">ë‹¤ìŒ &raquo;</a></li>
                {% endif %}
            </ul>
        </nav>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
